# ğŸ§  Product API POC

Une API FastAPI + GraphQL pour gÃ©rer un catalogue de produits multilingue avec recherche sÃ©mantique et fallback automatique.

---

## ğŸ› ï¸ Stack technique

- ğŸ”¥ FastAPI + Strawberry GraphQL
- ğŸ§± Architecture Hexagonale (Domain, UseCases, Interfaces, Services, Exposers)
- ğŸ¤— Transformers (LaBSE pour embeddings + MarianMT pour traduction)
- ğŸ Python 3.11 avec Poetry
- ğŸ§ª Tests en cours
- ğŸ³ Docker + Docker Compose

---

## ğŸ“ Structure

```
apis/
â”œâ”€â”€ domains/                     # EntitÃ©s mÃ©tiers (ProductInternal)
â”œâ”€â”€ usecases/
â”‚   â”œâ”€â”€ product/                 # create, list, search
â”‚   â””â”€â”€ i18n/                    # resolve (fallback)
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ embeddings/             # LaBSE + cosine similarity
â”‚   â”œâ”€â”€ i18n/                   # TranslationService (MarianMT)
â”‚   â””â”€â”€ db/                     # InMemory repo
â”œâ”€â”€ interfaces/repositories/    # Port abstrait
â”œâ”€â”€ exposers/
â”‚   â”œâ”€â”€ resolvers/              # GraphQL Queries / Mutations
â”‚   â””â”€â”€ schemas/                # GraphQL types et inputs
â”œâ”€â”€ main.py                     # EntrÃ©e FastAPI + schema GraphQL
â”œâ”€â”€ seed.py                     # Chargement de donnÃ©es via GraphQL
```

---

## ğŸš€ Lancer le projet

### 1. PrÃ©requis

- Docker & Docker Compose
- (Optionnel) Python 3.11 + Poetry

### 2. Lancement

```bash
docker-compose up --build
```

Accessible via : http://localhost:8000/graphql

---

## âœ¨ FonctionnalitÃ©s

### âœ… CrÃ©ation de produit (multilingue)

- Code produit unique
- Traductions multiples (title + description)
- Embedding des champs selon la langue prioritaire

### ğŸ” Recherche sÃ©mantique

- BasÃ©e sur LaBSE + SimilaritÃ© Cosinus
- Recherche sur titre puis fallback sur description
- Seuil de similaritÃ© configurable (0.7)
- RÃ©sultats enrichis dâ€™un champ `score`

### ğŸŒ Fallback de traduction automatique

- Si la locale demandÃ©e nâ€™est pas prÃ©sente :
  - Recherche une langue prioritaire disponible
  - Utilise MarianMT pour traduire dynamiquement

---

## ğŸ§ª Exemple de requÃªte GraphQL

```graphql
query {
  searchProducts(text: "gilet GREF01", locale: "fr") {
    code
    score
    translation {
      title
      description
    }
  }
}
```

---

## ğŸ“¦ DonnÃ©es de test

Un script de seed (`seed.py`) permet de charger un jeu de donnÃ©es multilingues via mutation GraphQL.

---

## ğŸ”® Ã€ venir

- Tests automatisÃ©s
- Indexation vectorielle (Faiss / Qdrant)
- Authentification
- Support de base SQL